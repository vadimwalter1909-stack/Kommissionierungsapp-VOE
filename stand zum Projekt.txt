Stand 21.01.26

Alles klar, Vadim â€” ich erstelle dir jetzt einen **Projektâ€‘Prompt**, der den *aktuellen Stand* deines Systems perfekt beschreibt.  
Das ist ein sauber formulierter, vollstÃ¤ndiger, narrensicherer Prompt, den du:

- fÃ¼r Dokumentation  
- fÃ¼r neue Entwickler  
- fÃ¼r zukÃ¼nftige KIâ€‘Sessions  
- fÃ¼r Architekturâ€‘Reviews  
- oder als â€Masterâ€‘Promptâ€œ fÃ¼r dein Projekt  

verwenden kannst.

Ich halte ihn **prÃ¤zise**, **technisch korrekt**, **vollstÃ¤ndig**, aber **nicht Ã¼berladen**.

---

# â­ **VOE â€“ Projektâ€‘Prompt (aktueller Stand)**  
*(Stand: nach Implementierung von Regelâ€¯C, Logistikâ€‘LadungstrÃ¤ger, Fehlteilâ€‘Logik, Scrollâ€‘Fix, Produktionsâ€‘LadungstrÃ¤ger, etc.)*

---

## **ğŸ“Œ Projektname**  
**VOE â€“ Kommissionierungsâ€‘ und Produktionssteuerungsâ€‘App**

Eine narrensichere Webâ€‘App zur Steuerung von Produktion, Logistik und Materialfluss.  
Technologieâ€‘Stack: **FastAPI**, **Jinja2**, **SQLite**, **Railway Deployment**, **Excelâ€‘Import**.

---

## **ğŸ“Œ Hauptziele der App**

1. **Produktionssteuerung**  
   - BÃ¼ndel gruppieren  
   - Produktionsfortschritt markieren  
   - Produktionsâ€‘LadungstrÃ¤ger erzeugen  
   - Produktionsauslieferung dokumentieren  

2. **Logistiksteuerung**  
   - Kommissionierung  
   - Fehlteilâ€‘Erkennung  
   - Fehlteilâ€‘Entscheidung (Regelâ€¯C)  
   - Logistikâ€‘LadungstrÃ¤ger erzeugen  
   - Auslieferung dokumentieren  

3. **Narrensichere Prozessabbildung**  
   - Keine doppelten Buttons  
   - Keine widersprÃ¼chlichen ZustÃ¤nde  
   - Keine Zombieâ€‘KÃ¼rzel  
   - Klare, eindeutige Statussignale  

---

## **ğŸ“Œ Datenmodell (Item)**  
Jeder Datensatz aus der Excel wird zu einem `Item`:

- `kuerzel`  
- `artikel_clean`  
- `artikel_nr`  
- `durchmesser`  
- `laenge`  
- `biegung`  
- `bedarfs_menge_pos`  
- `beschaffung`  
- `referenz`  
- `kommissioniert`  
- `fertig`  
- `ausgeliefert`  
- `ausgeliefert_am`  
- `ziel_lagerort`  
- `merge_key`  
- `prod_id`  
- `start_bft` *(Stichtag fÃ¼r Fehlteile)*  

---

## **ğŸ“Œ Produktionslogik**

### **BÃ¼ndelbildung**
Gruppierung nach:
- artikel_clean  
- artikel_nr  
- durchmesser  
- laenge  
- biegung  

### **Produktionsâ€‘LadungstrÃ¤ger**
Erzeugt, wenn:
- alle Produktionsartikel (`beschaffung=Produktion`)  
- fertig sind (`fertig=True`)  

EnthÃ¤lt:
- Menge  
- ProdIDs  
- row_keys  
- Dropdown fÃ¼r Zielort  
- Ausliefernâ€‘Button  

Nach Auslieferung:
- Kachel verschwindet  
- Status wird dokumentiert  

---

## **ğŸ“Œ Logistiklogik (Regelâ€¯C â€“ prÃ¤zisiert)**

### **1. Fehlteile (referenz="Bestellung") blockieren die Logistik**
Solange ein Fehlteil existiert:
- kein Logistikâ€‘LadungstrÃ¤ger  
- kein Ausliefern  
- kein Abschluss  

### **2. Kritische Fehlteile (ğŸ”¥ğŸ”¥ğŸ”¥)**
Wenn `start_bft <= heute`:
- Fehlteil wird kritisch  
- 3 Feuerâ€‘Icons erscheinen  
- Button erscheint:  
  **â€Nicht mehr benÃ¶tigt / ausbuchenâ€œ**

### **3. Fehlteil erledigt / ausbuchen**
Route: `/logistik/fehlteil_erledigt`

Setzt:
- `referenz = "Nicht mehr benÃ¶tigt"`  
- optional: Menge auf 0  
- optional: Timestamp  

Damit blockiert das Fehlteil NICHT mehr.

### **4. Kommissionierung**
- Offene BÃ¼ndel â†’ Button â€Kommissioniertâ€œ  
- Kommissionierte BÃ¼ndel â†’ âœ” Hinweis  
- Kein Ausliefernâ€‘Button in Gruppen  

### **5. Logistikâ€‘LadungstrÃ¤ger**
Erzeugt, wenn:
- **alle relevanten BÃ¼ndel kommissioniert**  
- **keine Fehlteile mehr existieren**  
- **noch nicht ausgeliefert**  

EnthÃ¤lt:
- Menge  
- ProdIDs  
- row_keys  
- Dropdown fÃ¼r Zielort  
- Ausliefernâ€‘Button  

### **6. Nach Auslieferung**
- Kachel verschwindet  
- Status dokumentiert  

---

## **ğŸ“Œ UIâ€‘Logik**

### **Detailseiten**
- Produktionsâ€‘Detailseite  
- Logistikâ€‘Detailseite (baugleich, aber mit Logistikâ€‘Buttons)  

### **Scrollâ€‘Fix**
Beim Klick auf:
- Kommissioniert  
- Fehlteil erledigt  

wird die Scrollposition gespeichert und wiederhergestellt.

### **Statusfarben**
- grau â†’ nichts kommissioniert  
- gelb â†’ teilweise kommissioniert  
- hellblau â†’ alles kommissioniert, Produktion nicht fertig  
- hellgrÃ¼n â†’ alles kommissioniert, Produktion fertig  

### **Fehlteilâ€‘Signale**
- normal: roter Button â€Fehlteilâ€œ  
- kritisch: ğŸ”¥ğŸ”¥ğŸ”¥ + â€Nicht mehr benÃ¶tigtâ€œ  

---

## **ğŸ“Œ Dateien (Stand jetzt)**

### **Backend**
- `backend/routes/logistik.py` (komplett neu strukturiert)  
- `backend/routes/produktion.py`  
- `backend/database.py`  
- `backend/database_base.py`  
- `backend/data/zielorte.json`  

### **Templates**
- `templates/logistik_detail.html` (neu, narrensicher)  
- `templates/produktion_detail.html`  
- `templates/logistik.html`  
- `templates/produktion.html`  
- `templates/base.html`  

---

## **ğŸ“Œ Offene Erweiterungen (optional)**

- Exportliste â€Ausgebuchte Fehlteileâ€œ  
- Schrottâ€‘/Ãœberbestandâ€‘Management  
- Historie pro KÃ¼rzel  
- Automatische Eâ€‘Mail bei kritischen Fehlteilen  
- Dashboardâ€‘Widget â€Heute fÃ¤llige KÃ¼rzelâ€œ  

---

# â­ Fertig.  
Das ist dein **Projektâ€‘Prompt**, vollstÃ¤ndig, narrensicher, technisch korrekt und sofort einsatzbereit.

Wenn du willst, kann ich dir:

- eine **Markdownâ€‘Version**  
- eine **PDFâ€‘Version**  
- eine **Kurzversion**  
- eine **Entwicklerâ€‘Onboardingâ€‘Version**  
- oder eine **Architekturâ€‘Version**  

erstellen.