{% extends "base.html" %}
{% block content %}

{# Moderne Navigation – Übersicht braucht keinen Back-Button #}
{% set page_title = "Dashboard – Gesamtfortschritt" %}
{% set back_url = None %}

<nav class="app-nav">
    <div class="nav-left">
        <span class="nav-title">{{ page_title }}</span>
    </div>
</nav>


{# ---------------------------------------------------------
   Export & Reset – modernisierte Button-Leiste
--------------------------------------------------------- #}
<div style="margin-bottom: 35px; display: flex; gap: 20px; flex-wrap: wrap;">

    {% if komplett_count == total and total > 0 %}
        <form action="/export/komplett" method="get">
            <button type="submit" class="bundle-button" style="min-width: 200px;">
                Excel exportieren
            </button>
        </form>
    {% else %}
        <button class="bundle-button"
                style="opacity: 0.4; cursor: not-allowed; min-width: 200px;"
                disabled>
            Excel exportieren
        </button>
    {% endif %}

    <form action="/export/reset" method="get">
        <button type="submit"
                class="bundle-button"
                style="background-color: #dc3545; min-width: 200px;"
                onclick="return confirm('Hast du die Excel-Datei erfolgreich gespeichert? Die App wird jetzt zurückgesetzt.');">
            App zurücksetzen
        </button>
    </form>

</div>


{# ---------------------------------------------------------
   Statistik-Box – modernisierte Card
--------------------------------------------------------- #}
<div class="bundle" style="max-width: 420px;">

    <div class="bundle-header">
        <div class="bundle-title">Fortschritt</div>
        <div class="bundle-subtitle">Gesamtübersicht aller Kürzel</div>
    </div>

    <p>Gesamt: {{ total }} Kürzel</p>
    <p>Produktion fertig: {{ prod_fertig_count }}</p>
    <p>Logistik fertig: {{ log_fertig_count }}</p>
    <p><strong>Komplett fertig: {{ komplett_count }}</strong></p>

    <div class="progress-bar" style="margin-top: 18px;">
        <div class="progress-fill" style="width: {{ progress }}%;"></div>
    </div>

    <div class="progress-label">{{ progress }}%</div>
</div>


{# ---------------------------------------------------------
   Fertige Kürzel – moderne Kacheln
--------------------------------------------------------- #}
<h2 style="margin-top: 40px;">Komplett fertige Kürzel</h2>

{% if items|length == 0 %}
    <p>Es gibt aktuell keine vollständig abgeschlossenen Kürzel.</p>
{% else %}
    <div class="tile-container">
        {% for k in items %}
            <a href="/dashboard/{{ k }}" class="tile tile-komplett">
                <div class="tile-left">
                    <h2 class="tile-title">{{ k }}</h2>
                    <p class="tile-info">Produktion ✔</p>
                    <p class="tile-info">Logistik ✔</p>
                </div>
                <div class="tile-right">
                    <span class="tile-icon">✔</span>
                </div>
            </a>
        {% endfor %}
    </div>
{% endif %}

{% endblock %}
